<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Test SDK v2.0 - NO Auto-Cleanup</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', monospace;
            max-width: 1200px;
            margin: 20px auto;
            padding: 20px;
            background: #1e1e1e;
            color: #d4d4d4;
        }
        h1 { color: #4ec9b0; }
        button {
            background: #0e639c;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover { background: #1177bb; }
        #output {
            background: #252526;
            padding: 15px;
            border-left: 3px solid #4ec9b0;
            margin-top: 20px;
            white-space: pre-wrap;
        }
        .success { color: #4ec9b0; }
        .error { color: #f48771; }
    </style>
</head>
<body>
    <h1>SDK v2.0 Test - NO Auto-Cleanup</h1>
    <p>This test demonstrates the SDK WITHOUT automatic cleanup.</p>
    <p>Handles are created but NOT released - this is intentional.</p>

    <button onclick="testBasicOps()">Test Basic Operations</button>
    <button onclick="testMathOps()">Test Math Operations</button>
    <button onclick="testDSPOps()">Test DSP Operations</button>

    <pre id="output">Click a button to run tests...</pre>

    <script type="module">
        import { Achronyme } from '../src/sdk/index.ts';

        let ach = null;

        // Initialize SDK once
        (async () => {
            ach = new Achronyme();
            await ach.init();
            document.getElementById('output').textContent = '✅ SDK initialized\nReady to run tests!';
        })();

        // Test 1: Basic vector creation (NO cleanup)
        window.testBasicOps = async function() {
            const output = document.getElementById('output');
            output.textContent = 'Running basic operations test...\n';

            try {
                // Create vectors - NO cleanup, handles will leak
                const v1 = ach.vector([1, 2, 3, 4, 5]);
                output.textContent += `✅ Vector created: length=${v1.length}\n`;
                output.textContent += `   Data: [${Array.from(v1.data).join(', ')}]\n`;

                const v2 = ach.linspace(0, 10, 5);
                output.textContent += `✅ Linspace created: length=${v2.length}\n`;
                output.textContent += `   Data: [${Array.from(v2.data).map(x => x.toFixed(2)).join(', ')}]\n`;

                output.textContent += '\n<span class="success">✅ ALL BASIC OPERATIONS PASSED!</span>\n';
                output.textContent += '\n⚠️  Note: Handles NOT released (manual cleanup required)\n';

            } catch (error) {
                output.textContent += `\n<span class="error">❌ ERROR: ${error.message}</span>\n`;
                console.error('Full error:', error);
            }
        };

        // Test 2: Math operations (NO cleanup)
        window.testMathOps = async function() {
            const output = document.getElementById('output');
            output.textContent = 'Running math operations test...\n';

            try {
                const v = ach.vector([0, Math.PI/4, Math.PI/2, Math.PI]);
                output.textContent += `✅ Input vector created: length=${v.length}\n`;

                const sinV = ach.sin(v);
                output.textContent += `✅ sin() computed\n`;
                output.textContent += `   sin values: [${Array.from(sinV.data).map(x => x.toFixed(4)).join(', ')}]\n`;

                const cosV = ach.cos(v);
                output.textContent += `✅ cos() computed\n`;
                output.textContent += `   cos values: [${Array.from(cosV.data).map(x => x.toFixed(4)).join(', ')}]\n`;

                output.textContent += '\n<span class="success">✅ ALL MATH OPERATIONS PASSED!</span>\n';
                output.textContent += '\n⚠️  Note: Handles NOT released (manual cleanup required)\n';

            } catch (error) {
                output.textContent += `\n<span class="error">❌ ERROR: ${error.message}</span>\n`;
                console.error('Full error:', error);
            }
        };

        // Test 3: DSP operations (NO cleanup)
        window.testDSPOps = async function() {
            const output = document.getElementById('output');
            output.textContent = 'Running DSP operations test...\n';

            try {
                const signal = ach.linspace(0, 2 * Math.PI, 64);
                output.textContent += `✅ Signal created: length=${signal.length}\n`;

                const spectrum = ach.fft_mag(signal);
                output.textContent += `✅ FFT magnitude computed: length=${spectrum.length}\n`;
                output.textContent += `   First 5 magnitudes: [${Array.from(spectrum.data).slice(0, 5).map(x => x.toFixed(4)).join(', ')}]\n`;

                output.textContent += '\n<span class="success">✅ ALL DSP OPERATIONS PASSED!</span>\n';
                output.textContent += '\n⚠️  Note: Handles NOT released (manual cleanup required)\n';

            } catch (error) {
                output.textContent += `\n<span class="error">❌ ERROR: ${error.message}</span>\n`;
                console.error('Full error:', error);
            }
        };
    </script>
</body>
</html>
