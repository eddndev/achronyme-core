// Test de rendimiento para funciones recursivas
// Este script demuestra la mejora de rendimiento con el nuevo Environment

// Función recursiva simple - factorial
let factorial = n => if(n <= 1, 1, n * rec(n - 1))

// Probar con un número moderado
let result1 = factorial(10)

// Función recursiva con closure
let makeCounter = start => {
    current: start,
    increment: () => {
        current: self.current + 1,
        increment: self.increment,
        value: self.value
    },
    value: () => self.current
}

let counter = makeCounter(0)
let c1 = counter.increment()
let c2 = c1.increment()
let c3 = c2.increment()
let finalValue = c3.value()

// Fibonacci recursivo (más pesado)
let fib = n => if(n <= 1, n, rec(n-1) + rec(n-2))
let result2 = fib(15)

// Función con captura de variables
let x = 10
let y = 20
let addXY = z => x + y + z
let result3 = addXY(30)

// Composición funcional
let compose = f => g => x => f(g(x))
let double = n => n * 2
let add3 = n => n + 3
let composed = compose(double)(add3)
let result4 = composed(5)

// Output de resultados
result1    // 3628800
finalValue // 3
result2    // 610
result3    // 60
result4    // 16
